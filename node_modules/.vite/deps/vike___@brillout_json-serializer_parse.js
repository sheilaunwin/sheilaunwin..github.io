import {
  types
} from "./chunk-OT4DE2KZ.js";
import "./chunk-DC5AMYBS.js";

// node_modules/@brillout/json-serializer/dist/parse.js
function parse(str, options = {}) {
  const value = JSON.parse(str);
  return parseTransform(value, options);
}
function parseTransform(value, options = {}) {
  if (typeof value === "string") {
    return reviver(value, options);
  }
  if (
    // Also matches arrays
    typeof value === "object" && value !== null
  ) {
    Object.entries(value).forEach(([key, val]) => {
      ;
      value[key] = parseTransform(val, options);
    });
  }
  return value;
}
function reviver(value, options) {
  var _a;
  const parser = (str) => parse(str, options);
  {
    const res = (_a = options.reviver) == null ? void 0 : _a.call(
      options,
      // TO-DO/eventually: provide key if some user needs it
      void 0,
      value,
      parser
    );
    if (res) {
      if (typeof res.replacement !== "string") {
        return res.replacement;
      } else {
        value = res.replacement;
        if (res.resolved)
          return value;
      }
    }
  }
  for (const { match, deserialize } of types) {
    if (match(value)) {
      return deserialize(value, parser);
    }
  }
  return value;
}
export {
  parse,
  parseTransform
};
//# sourceMappingURL=vike___@brillout_json-serializer_parse.js.map
